## Действие (GameAction)

Действие (Action) — это модель, описывающая целенаправленное воздействие [Entity](./entity.md) (как правило, игрока) на состояние игры.

*Примеры из реальной карточной игры*:

* Вытягивание карты из колоды
* Размещение карты на столе
* Атака монстра
* Продажа предмета (шмотки)

### Действия с параметром

Иногда игроку нужно передать некоторую дополнительную информацию с действием, для этого используются **параметрические действия** **GameAction\<T>**:
*Проблема*: Допустим, игроку выпало проклятье, заставляющее его выбросить выбранную карту со стола. Мы можем создать действие GameAction\<Card>, но система не поймёт — что это за карта и откуда её брать?

*Решение*: система **специализированных параметров**, которые явно указывают источник и тип данных:

* **GameAction\<FromHand>** - карта из руки
* **GameAction\<FromTable>** - карта со стола
* **GameAction\<FromHandMany>** - несколько карт из руки
* **GameAction\<FromTableMany>** - несколько карт со стола

*Примечание*: Скорее всего есть много других сценариев которые я не учёл.

### Selector'ы

**Selector** - описывает как должен определяться параметр действия:
 К примеру IActionSelector\<GameHand> - будет описывать, что GameHand это та карта, что берётся из руки игрока.

 ### Установка параметров

 Игрок в любой момент времени имеет ограниченное количество разрешенных действий. Действия устанавливаются в [правилах](./rule.md) для каждого игрока отдельно с помощью accessor'а:

 * Current - текущий игрок в очереди
 * Other - другие игроки (вне очереди)
 * All - все игроки
 * Executor - игрок, что вызвал действие триггер

 Когда игроку устанавливаются новые действия предыдущие удаляются автоматически, но удаление можно отключить, указав это вручную.
Также нужно учесть, что правила не устанавливают действия напрямую игроку. Вместо этого они помещаются в очередь (HashSet), которая затем применяется к конечному игроку. Это нужно для разрешения конфликтов двух одновременно сработавших правил.